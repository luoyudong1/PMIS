<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kthw.pmis.mapper.common.SheetDetailMapper">
    <resultMap id="ExtendResultMap"
               type="com.kthw.pmis.entiy.dto.SheetDetailDTO">
        <id column="sheet_id" jdbcType="VARCHAR" property="sheetId"/>
        <id column="part_code" jdbcType="VARCHAR" property="partCode"/>
        <result column="quantity" jdbcType="NUMERIC"
                property="quantity"/>
        <result column="unit_price" jdbcType="NUMERIC"
                property="unitPrice"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="location" jdbcType="VARCHAR"
                property="location"/>
        <result column="part_id" jdbcType="VARCHAR" property="partId"/>
        <result column="asset_attributes_id" jdbcType="NUMERIC"
                property="assetAttributesId"/>
        <result column="fault_info" jdbcType="VARCHAR"
                property="faultInfo"/>
        <result column="fault_date" jdbcType="TIMESTAMP"
                property="faultDate"/>
        <result column="fault_remark" jdbcType="VARCHAR"
                property="faultRemark"/>
        <result column="prepare_check" jdbcType="VARCHAR"
                property="prepareCheck"/>
        <result column="machine_check" jdbcType="VARCHAR"
                property="machineCheck"/>
        <result column="replace_component_check" jdbcType="VARCHAR"
                property="replaceComponentCheck"/>
        <result column="copy_machine_start_time" jdbcType="TIMESTAMP"
                property="copyMachineStartTime"/>
        <result column="copy_machine_end_time" jdbcType="TIMESTAMP"
                property="copyMachineEndTime"/>
        <result column="copy_machine_check" jdbcType="VARCHAR"
                property="copyMachineCheck"/>
        <result column="checked_date" jdbcType="TIMESTAMP"
                property="checkedDate"/>
        <result column="checked_user_id" jdbcType="VARCHAR"
                property="checkedUserId"/>
        <result column="checked_user_name" jdbcType="VARCHAR"
                property="checkedUserName"/>
        <result column="review_user_id" jdbcType="VARCHAR"
                property="reviewUserId"/>
        <result column="review_user_name" jdbcType="VARCHAR"
                property="reviewUserName"/>
        <result column="checked_remark" jdbcType="VARCHAR"
                property="checkedRemark"/>
        <result column="checked_price" jdbcType="NUMERIC"
                property="checkedPrice"/>
        <result column="repaire_state" jdbcType="NUMERIC"
                property="repaireState"/>
        <result column="scrap_reason" jdbcType="VARCHAR"
                property="scrapReason"/>
        <result column="factory_replace_component" jdbcType="VARCHAR"
                property="factoryReplaceComponent"/>
        <result column="factory_replace_count" jdbcType="NUMERIC"
                property="factoryReplaceCount"/>
        <result column="factory_repaired_price" jdbcType="NUMERIC"
                property="factoryRepairedPrice"/>
        <result column="factory_repaired_date" jdbcType="TIMESTAMP"
                property="factoryRepairedDate"/>
        <result column="used_station_name" jdbcType="VARCHAR"
                property="usedStationName"/>
        <result column="used_station_id" jdbcType="NUMERIC"
                property="usedStationId"/>
        <result column="purchase_or_repaired_date" jdbcType="TIMESTAMP"
                property="purchaseOrRepairedDate"/>
        <result column="purchase_or_repaired_price" jdbcType="NUMERIC"
                property="purchaseOrRepairedPrice"/>
        <result column="part_state" jdbcType="NUMERIC"
                property="partState"/>
        <result column="create_time" jdbcType="TIMESTAMP"
                property="createTime"/>
        <result column="update_time" jdbcType="TIMESTAMP"
                property="updateTime"/>
        <result column="purchase_date" jdbcType="TIMESTAMP"
                property="purchaseDate"/>
        <result column="purchase_price" jdbcType="NUMERIC"
                property="purchasePrice"/>
        <result column="device_parts_name" jdbcType="VARCHAR"
                property="devicePartsName"/>
        <result column="device_model_name" jdbcType="VARCHAR"
                property="deviceModelName"/>
        <result column="device_type_name" jdbcType="VARCHAR"
                property="deviceTypeName"/>
        <result column="supplier_name" jdbcType="VARCHAR"
                property="supplierName"/>
        <result column="asset_attributes_name" jdbcType="VARCHAR"
                property="assetAttributesName"/>
        <result column="assetAttrName" jdbcType="VARCHAR"
                property="assetAttrName"/>
        <result column="send_verify_flag" jdbcType="NUMERIC"
                property="sendVerifyFlag"/>
        <result column="receipt_verify_flag" jdbcType="NUMERIC"
                property="receiptVerifyFlag"/>
        <result column="warranty" jdbcType="NUMERIC"
                property="warranty"/>
        <result column="asset_attr_id" jdbcType="NUMERIC"
                property="assetAttrId"/>
        <result column="parts_state" jdbcType="NUMERIC"
                property="partsState"/>
        <result column="detect_parts_id" jdbcType="NUMERIC"
                property="detectPartsId"/>
        <result column="sourceStoreHouseName" jdbcType="VARCHAR"
                property="sourceStoreHouseName"/>
        <result column="objectStoreHouseName" jdbcType="VARCHAR"
                property="objectStoreHouseName"/>
        <result column="detectDeviceId" jdbcType="NUMERIC"
                property="detectDeviceId"/>
        <result column="detectDeviceName" jdbcType="VARCHAR"
                property="detectDeviceName"/>
        <result column="send_operator_name" jdbcType="VARCHAR"
                property="sendOperatorName"/>
        <result column="send_verify_name" jdbcType="VARCHAR"
                property="sendVerifyName"/>
        <result column="receipt_operator_name" jdbcType="VARCHAR"
                property="receiptOperatorName"/>
        <result column="receipt_verify_name" jdbcType="VARCHAR"
                property="receiptVerifyName"/>
        <result column="add_date" jdbcType="TIMESTAMP"
                property="addDate"/>
        <result column="new_part_code" jdbcType="VARCHAR"
                property="newPartCode"/>
        <result column="new_repair_price" jdbcType="NUMERIC"
                property="newRepairPrice"/>

    </resultMap>
<resultMap id="BaseResultMap" type="com.kthw.pmis.entiy.SheetDetail">
    <id column="sheet_id" jdbcType="VARCHAR" property="sheetId"/>
    <id column="part_code" jdbcType="VARCHAR" property="partCode"/>
    <result column="quantity" jdbcType="NUMERIC"
            property="quantity"/>
    <result column="unit_price" jdbcType="NUMERIC"
            property="unitPrice"/>
    <result column="remark" jdbcType="VARCHAR" property="remark"/>
    <result column="location" jdbcType="VARCHAR"
            property="location"/>
    <result column="part_id" jdbcType="VARCHAR" property="partId"/>
    <result column="asset_attributes_id" jdbcType="NUMERIC"
            property="assetAttributesId"/>
    <result column="fault_info" jdbcType="VARCHAR"
            property="faultInfo"/>
    <result column="fault_date" jdbcType="TIMESTAMP"
            property="faultDate"/>
    <result column="fault_remark" jdbcType="VARCHAR"
            property="faultRemark"/>
    <result column="prepare_check" jdbcType="VARCHAR"
            property="prepareCheck"/>
    <result column="machine_check" jdbcType="VARCHAR"
            property="machineCheck"/>
    <result column="replace_component_check" jdbcType="VARCHAR"
            property="replaceComponentCheck"/>
    <result column="copy_machine_start_time" jdbcType="TIMESTAMP"
            property="copyMachineStartTime"/>
    <result column="copy_machine_end_time" jdbcType="TIMESTAMP"
            property="copyMachineEndTime"/>
    <result column="copy_machine_check" jdbcType="VARCHAR"
            property="copyMachineCheck"/>
    <result column="checked_date" jdbcType="TIMESTAMP"
            property="checkedDate"/>
    <result column="checked_user_id" jdbcType="VARCHAR"
            property="checkedUserId"/>
    <result column="checked_user_name" jdbcType="VARCHAR"
            property="checkedUserName"/>
    <result column="review_user_id" jdbcType="VARCHAR"
            property="reviewUserId"/>
    <result column="review_user_name" jdbcType="VARCHAR"
            property="reviewUserName"/>
    <result column="checked_remark" jdbcType="VARCHAR"
            property="checkedRemark"/>
    <result column="checked_price" jdbcType="NUMERIC"
            property="checkedPrice"/>
    <result column="repaire_state" jdbcType="NUMERIC"
            property="repaireState"/>
    <result column="scrap_reason" jdbcType="VARCHAR"
            property="scrapReason"/>
    <result column="factory_replace_component" jdbcType="VARCHAR"
            property="factoryReplaceComponent"/>
    <result column="factory_replace_count" jdbcType="NUMERIC"
            property="factoryReplaceCount"/>
    <result column="factory_repaired_price" jdbcType="NUMERIC"
            property="factoryRepairedPrice"/>
    <result column="factory_repaired_date" jdbcType="TIMESTAMP"
            property="factoryRepairedDate"/>
    <result column="used_station_name" jdbcType="VARCHAR"
            property="usedStationName"/>
    <result column="used_station_id" jdbcType="NUMERIC"
            property="usedStationId"/>
    <result column="purchase_or_repaired_date" jdbcType="TIMESTAMP"
            property="purchaseOrRepairedDate"/>
    <result column="purchase_or_repaired_price" jdbcType="NUMERIC"
            property="purchaseOrRepairedPrice"/>
    <result column="part_state" jdbcType="NUMERIC"
            property="partState"/>
    <result column="warranty" jdbcType="NUMERIC"
            property="warranty"/>
    <result column="create_time" jdbcType="TIMESTAMP"
            property="createTime"/>
    <result column="update_time" jdbcType="TIMESTAMP"
            property="updateTime"/>
    <result column="purchase_date" jdbcType="TIMESTAMP"
            property="purchaseDate"/>
    <result column="detect_parts_id" jdbcType="NUMERIC"
            property="detectPartsId"/>
    <result column="new_part_code" jdbcType="VARCHAR"
            property="newPartCode"/>
    <result column="new_repair_price" jdbcType="NUMERIC"
            property="newRepairPrice"/>
</resultMap>
    <sql id="Base_Column_List">
		sheet_id, part_id, quantity, unit_price, remark, location,
		part_code,
		asset_attributes_id,
		fault_info, fault_date, fault_remark,
		prepare_check, machine_check,
		replace_component_check,
		copy_machine_start_time, copy_machine_end_time, copy_machine_check,
		checked_date,
		checked_user_id, checked_user_name, review_user_id,
		review_user_name,
		checked_remark,
		checked_price, repaire_state,
		scrap_reason, factory_replace_component,
		factory_replace_count,
		factory_repaired_price, factory_repaired_date, used_station_name,
		used_station_id,
		purchase_or_repaired_date, purchase_or_repaired_price,
		part_state,warranty,detect_parts_id,create_time,update_time,purchase_date,new_part_code,new_repair_price
	</sql>
    <sql id="ByMap_Where_Clause">
        <where>
            <if test="eqSheetId != null">
                AND sheet_id = #{eqSheetId,jdbcType=VARCHAR}
            </if>
            <if test="eqPartId != null">
                AND part_id = #{eqPartId,jdbcType=VARCHAR}
            </if>
            <if test="eqQuantity != null">
                AND quantity = #{eqQuantity,jdbcType=NUMERIC}
            </if>
            <if test="eqUnitPrice != null">
                AND unit_price = #{eqUnitPrice,jdbcType=NUMERIC}
            </if>
            <if test="eqRemark != null">
                AND remark = #{eqRemark,jdbcType=VARCHAR}
            </if>
            <if test="eqLocation != null">
                AND location = #{eqLocation,jdbcType=VARCHAR}
            </if>
            <if test="eqPartCode != null">
                AND part_code = #{eqPartCode,jdbcType=VARCHAR}
            </if>
            <if test="eqAssetAttributesId != null">
                AND asset_attributes_id =
                #{eqAssetAttributesId,jdbcType=NUMERIC}
            </if>
            <if test="eqFaultInfo != null">
                AND fault_info = #{eqFaultInfo,jdbcType=VARCHAR}
            </if>
            <if test="eqFaultDate != null">
                AND fault_date = #{eqFaultDate,jdbcType=TIMESTAMP}
            </if>
            <if test="eqFaultRemark != null">
                AND fault_remark = #{eqFaultRemark,jdbcType=VARCHAR}
            </if>
            <if test="eqPrepareCheck != null">
                AND prepare_check = #{eqPrepareCheck,jdbcType=VARCHAR}
            </if>
            <if test="eqMachineCheck != null">
                AND machine_check = #{eqMachineCheck,jdbcType=VARCHAR}
            </if>
            <if test="eqReplaceComponentCheck != null">
                AND replace_component_check =
                #{eqReplaceComponentCheck,jdbcType=VARCHAR}
            </if>
            <if test="eqCopyMachineStartTime != null">
                AND copy_machine_start_time =
                #{eqCopyMachineStartTime,jdbcType=TIMESTAMP}
            </if>
            <if test="eqCopyMachineEndTime != null">
                AND copy_machine_end_time =
                #{eqCopyMachineEndTime,jdbcType=TIMESTAMP}
            </if>
            <if test="eqCopyMachineCheck != null">
                AND copy_machine_check =
                #{eqCopyMachineCheck,jdbcType=VARCHAR}
            </if>
            <if test="eqCheckedDate != null">
                AND checked_date = #{eqCheckedDate,jdbcType=TIMESTAMP}
            </if>
            <if test="eqCheckedUserId != null">
                AND checked_user_id = #{eqCheckedUserId,jdbcType=VARCHAR}
            </if>
            <if test="eqCheckedUserName != null">
                AND checked_user_name =
                #{eqCheckedUserName,jdbcType=VARCHAR}
            </if>
            <if test="eqReviewUserId != null">
                AND review_user_id = #{eqReviewUserId,jdbcType=VARCHAR}
            </if>
            <if test="eqReviewUserName != null">
                AND review_user_name =
                #{eqReviewUserName,jdbcType=VARCHAR}
            </if>
            <if test="eqCheckedRemark != null">
                AND checked_remark = #{eqCheckedRemark,jdbcType=VARCHAR}
            </if>
            <if test="eqCheckedPrice != null">
                AND checked_price = #{eqCheckedPrice,jdbcType=NUMERIC}
            </if>
            <if test="eqRepaireState != null">
                AND repaire_state = #{eqRepaireState,jdbcType=NUMERIC}
            </if>
            <if test="eqScrapReason != null">
                AND scrap_reason = #{eqScrapReason,jdbcType=VARCHAR}
            </if>
            <if test="eqFactoryReplaceComponent != null">
                AND factory_replace_component =
                #{eqFactoryReplaceComponent,jdbcType=VARCHAR}
            </if>
            <if test="eqFactoryReplaceCount != null">
                AND factory_replace_count =
                #{eqFactoryReplaceCount,jdbcType=NUMERIC}
            </if>
            <if test="eqFactoryRepairedPrice != null">
                AND factory_repaired_price =
                #{eqFactoryRepairedPrice,jdbcType=NUMERIC}
            </if>
            <if test="eqFactoryRepairedDate != null">
                AND factory_repaired_date =
                #{eqFactoryRepairedDate,jdbcType=TIMESTAMP}
            </if>
            <if test="eqUsedStationName != null">
                AND used_station_name =
                #{eqUsedStationName,jdbcType=VARCHAR}
            </if>
            <if test="eqUsedStationId != null">
                AND used_station_id = #{eqUsedStationId,jdbcType=NUMERIC}
            </if>
            <if test="eqPurchaseOrRepairedDate != null">
                AND purchase_or_repaired_date =
                #{eqPurchaseOrRepairedDate,jdbcType=TIMESTAMP}
            </if>
            <if test="eqPurchaseOrRepairedPrice != null">
                AND purchase_or_repaired_price =
                #{eqPurchaseOrRepairedPrice,jdbcType=NUMERIC}
            </if>
            <if test="eqPartState != null">
                AND part_state = #{eqPartState,jdbcType=NUMERIC}
            </if>
            <if test="eqWarranty != null">
                AND warranty = #{eqWarranty,jdbcType=NUMERIC}
            </if>
            <if test="eqDetectPartsId != null">
                AND detect_parts_id = #{eqDetectPartsId,jdbcType=NUMERIC}
            </if>
            <if test="eqCreateTime != null">
                AND create_time = #{eqCreateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="eqUpdateTime != null">
                AND update_time = #{eqUpdateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="eqDetectPartsId != null">
                AND update_time = #{eqUpdateTime,jdbcType=TIMESTAMP}
            </if>

        </where>
    </sql>
    <sql id="ByMap_Set_Clause">
        <set>
            <if test="quantity != null">
                quantity = #{quantity,jdbcType=NUMERIC},
            </if>
            <if test="unitPrice != null">
                unit_price = #{unitPrice,jdbcType=NUMERIC},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="location != null">
                location = #{location,jdbcType=VARCHAR},
            </if>
            <if test="partId != null">
                part_id = #{partId,jdbcType=VARCHAR},
            </if>
            <if test="assetAttributesId != null">
                asset_attributes_id =
                #{assetAttributesId,jdbcType=NUMERIC},
            </if>
            <if test="faultInfo != null">
                fault_info = #{faultInfo,jdbcType=VARCHAR},
            </if>
            <if test="faultDate != null">
                fault_date = #{faultDate,jdbcType=TIMESTAMP},
            </if>
            <if test="faultRemark != null">
                fault_remark = #{faultRemark,jdbcType=VARCHAR},
            </if>
            <if test="prepareCheck != null">
                prepare_check = #{prepareCheck,jdbcType=VARCHAR},
            </if>
            <if test="machineCheck != null">
                machine_check = #{machineCheck,jdbcType=VARCHAR},
            </if>
            <if test="replaceComponentCheck != null">
                replace_component_check =
                #{replaceComponentCheck,jdbcType=VARCHAR},
            </if>
            <if test="copyMachineStartTime != null">
                copy_machine_start_time =
                #{copyMachineStartTime,jdbcType=TIMESTAMP},
            </if>
            <if test="copyMachineEndTime != null">
                copy_machine_end_time =
                #{copyMachineEndTime,jdbcType=TIMESTAMP},
            </if>
            <if test="copyMachineCheck != null">
                copy_machine_check =
                #{copyMachineCheck,jdbcType=VARCHAR},
            </if>
            <if test="checkedDate != null">
                checked_date = #{checkedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="checkedUserId != null">
                checked_user_id = #{checkedUserId,jdbcType=VARCHAR},
            </if>
            <if test="checkedUserName != null">
                checked_user_name = #{checkedUserName,jdbcType=VARCHAR},
            </if>
            <if test="reviewUserId != null">
                review_user_id = #{reviewUserId,jdbcType=VARCHAR},
            </if>
            <if test="reviewUserName != null">
                review_user_name = #{reviewUserName,jdbcType=VARCHAR},
            </if>
            <if test="checkedRemark != null">
                checked_remark = #{checkedRemark,jdbcType=VARCHAR},
            </if>
            <if test="checkedPrice != null">
                checked_price = #{checkedPrice,jdbcType=NUMERIC},
            </if>
            <if test="repaireState != null">
                repaire_state = #{repaireState,jdbcType=NUMERIC},
            </if>
            <if test="scrapReason != null">
                scrap_reason = #{scrapReason,jdbcType=VARCHAR},
            </if>
            <if test="factoryReplaceComponent != null">
                factory_replace_component =
                #{factoryReplaceComponent,jdbcType=VARCHAR},
            </if>
            <if test="factoryReplaceCount != null">
                factory_replace_count =
                #{factoryReplaceCount,jdbcType=NUMERIC},
            </if>
            <if test="factoryRepairedPrice != null">
                factory_repaired_price =
                #{factoryRepairedPrice,jdbcType=NUMERIC},
            </if>
            <if test="factoryRepairedDate != null">
                factory_repaired_date =
                #{factoryRepairedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="usedStationName != null">
                used_station_name = #{usedStationName,jdbcType=VARCHAR},
            </if>
            <if test="usedStationId != null">
                used_station_id = #{usedStationId,jdbcType=NUMERIC},
            </if>
            <if test="purchaseOrRepairedDate != null">
                purchase_or_repaired_date =
                #{purchaseOrRepairedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="purchaseOrRepairedPrice != null">
                purchase_or_repaired_price =
                #{purchaseOrRepairedPrice,jdbcType=NUMERIC},
            </if>
            <if test="partState != null">
                part_state = #{partState,jdbcType=NUMERIC},
            </if>
            <if test="warranty != null">
                warranty = #{warranty,jdbcType=NUMERIC},
            </if>
            <if test="detectPartsId != null">
                detect_parts_id = #{detectPartsId,jdbcType=NUMERIC}
            </if>
            <if test="newPartCode != null">
               new_part_code= #{newPartCode,jdbcType=VARCHAR}
            </if>
        </set>
    </sql>
    <select id="selectByPrimaryKey"
            parameterType="com.kthw.pmis.entiy.SheetDetailKey"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from tbl_sheet_detail
        where sheet_id = #{sheetId,jdbcType=VARCHAR}
        and
        part_code = #{partCode,jdbcType=VARCHAR}
    </select>
    <select id="selectByMap" parameterType="java.util.Map"
            resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from tbl_sheet_detail
        <if test="_parameter != null">
            <include refid="ByMap_Where_Clause"/>
            <if test="orderByClause != null">
                order by ${orderByClause}
            </if>
        </if>
    </select>
    <select id="getParamsCount" parameterType="java.util.Map"
            resultType="java.lang.Integer">
        select
        count(*)
        from tbl_sheet_detail sd
        left join view_parts_dict vp
        on
        substring(sd.part_id,1,5)=vp.parts_code
        left join tbl_stock_info st
        on sd.part_id=st.part_id_seq
        left join tbl_asset_attributes aa
        on st.asset_attributes_id=aa.asset_attributes_id
        left join tbl_detect_device_dict ddd on st.device_id=ddd.detect_device_id
        left join tbl_sheet_info si
        on
        si.sheet_id=sd.sheet_id
        <where>
            <if test='eqSheetId != null and eqSheetId != ""'>
                and sd.sheet_id=#{eqSheetId}
            </if>
            <if test='sheetId != null and sheetId != ""'>
                and sd.sheet_id like #{sheetId}
            </if>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
                and
                si.source_store_house_id=to_number(#{sourceStoreHouseId},'9')
            </if>
            <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
                and
                si.object_store_house_id=to_number(#{objectStoreHouseId},'9')
            </if>
            <if test='partId != null and partId != ""'>
                and sd.part_id like #{partId}
            </if>
            <if test='partCode != null and partCode != ""'>
                and sd.part_code like #{partCode}
            </if>
            <if test='eqPartId != null and eqPartId != ""'>
                and sd.part_id=#{eqPartId}
            </if>
            <if test='eqPartCode != null and eqPartCode != ""'>
                and sd.part_code =#{eqPartCode}
            </if>
            <if test='devicePartsName != null and devicePartsName != ""'>
                and vp.device_parts_name = #{devicePartsName}
            </if>

            <if test='deviceModelName != null and deviceModelName != ""'>
                and vp.device_model_name=#{deviceModelName}
            </if>

            <if test='deviceTypeName != null and deviceTypeName != ""'>
                and vp.device_type_name=#{deviceTypeName}
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.add_date >= to_timestamp(#{queryTime},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.add_date &lt;= to_timestamp(#{queryTime2},'yyyy-mm-dd hh24:mi:ss')
            </if>

        </where>
    </select>
    <select id="selectWithParts" parameterType="java.util.Map"
            resultMap="ExtendResultMap">
        select
        sd.sheet_id as sheet_id, sd.part_id, quantity,sd.unit_price,
        sd.remark,
        location,
        part_code,
        aa.asset_attributes_id,
        sd.asset_attributes_name as assetAttrName,
        fault_info,
        fault_date,
        fault_remark,
        prepare_check, machine_check,
        replace_component_check,
        copy_machine_start_time,
        copy_machine_end_time, copy_machine_check,
        checked_date,
        checked_user_id, checked_user_name, review_user_id,
        review_user_name,
        checked_remark,
        checked_price, repaire_state,
        scrap_reason,
        factory_replace_component,
        factory_replace_count,
        factory_repaired_price, factory_repaired_date,used_station_name,
        used_station_id,
        purchase_or_repaired_date, purchase_or_repaired_price,
        sd.new_part_code,sd.new_repair_price,
        sd.part_state,sd.warranty,detect_parts_id,device_parts_name,device_model_name,device_type_name,vp.supplier_name
        as
        supplier_name,aa.asset_attributes_name as asset_attributes_name,send_verify_flag,receipt_verify_flag,
        sd1.storehouse_name as sourceStoreHouseName,
        sd2.storehouse_name as objectStoreHouseName,
        ddd.detect_device_id as detectDeviceId,
        ddd.detect_device_name as detectDeviceName,
        sd.create_time,sd.update_time,sd.purchase_date,si.send_operator_name,si.send_verify_name
        ,si.receipt_operator_name,si.receipt_verify_name,si.add_date
        from tbl_sheet_detail sd
        left join view_parts_dict vp
        on
        substring(sd.part_id,1,5)=vp.parts_code
        left join tbl_stock_info st
        on sd.part_code=st.factory_parts_code
        left join tbl_asset_attributes aa
        on sd.asset_attributes_id=aa.asset_attributes_id
        left join tbl_detect_device_dict ddd on st.device_id=ddd.detect_device_id
        left join tbl_sheet_info si
        on
        si.sheet_id=sd.sheet_id
        left join tbl_storehouse_dict sd1 on si.source_store_house_id=sd1.storehouse_id
        left join tbl_storehouse_dict sd2 on si.object_store_house_id=sd2.storehouse_id
        <where>
            <if test='eqSheetId != null and eqSheetId != ""'>
                and sd.sheet_id=#{eqSheetId}
            </if>
            <if test='sheetId != null and sheetId != ""'>
                and sd.sheet_id like #{sheetId}
            </if>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
                and
                si.source_store_house_id=to_number(#{sourceStoreHouseId},'9')
            </if>
            <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
                and
                si.object_store_house_id=to_number(#{objectStoreHouseId},'9')
            </if>
            <if test='partId != null and partId != ""'>
                and sd.part_id like #{partId}
            </if>
            <if test='partCode != null and partCode != ""'>
                and sd.part_code like #{partCode}
            </if>
            <if test='eqPartId != null and eqPartId != ""'>
                and sd.part_id=#{eqPartId}
            </if>
            <if test='eqPartCode != null and eqPartCode != ""'>
                and sd.part_code =#{eqPartCode}
            </if>
            <if test='devicePartsName != null and devicePartsName != ""'>
                and vp.device_parts_name = #{devicePartsName}
            </if>

            <if test='deviceModelName != null and deviceModelName != ""'>
                and vp.device_model_name=#{deviceModelName}
            </if>

            <if test='deviceTypeName != null and deviceTypeName != ""'>
                and vp.device_type_name=#{deviceTypeName}
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.add_date >= to_timestamp(#{queryTime},
                'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.add_date &lt;= to_timestamp(#{queryTime2},
                'yyyy-mm-dd hh24:mi:ss')
            </if>


            <if test="length != null and start!=null">
                limit #{length} offset {start}
            </if>
            order by sd.create_time desc
        </where>
    </select> <select id="selectDeliverySheetDetails" parameterType="java.util.Map"
                      resultMap="ExtendResultMap">
    select
    sd.sheet_id as sheet_id, sd.part_id, quantity,vp.unit_price,
    sd.remark,
    location,
    part_code,
    aa.asset_attributes_id,
    sd.asset_attributes_name as assetAttrName,
    fault_info,
    fault_date,
    fault_remark,
    prepare_check, machine_check,
    replace_component_check,
    copy_machine_start_time,
    copy_machine_end_time, copy_machine_check,
    checked_date,
    checked_user_id, checked_user_name, review_user_id,
    review_user_name,
    checked_remark,
    checked_price, repaire_state,
    scrap_reason,
    factory_replace_component,
    factory_replace_count,
    factory_repaired_price, factory_repaired_date,used_station_name,
    used_station_id,
    purchase_or_repaired_date, purchase_or_repaired_price,new_repair_price,
    part_state,sd.warranty,detect_parts_id,device_parts_name,device_model_name,device_type_name,vp.supplier_name
    as
    supplier_name,aa.asset_attributes_name as asset_attributes_name,send_verify_flag,receipt_verify_flag,
    sd1.storehouse_name as sourceStoreHouseName,
    sd2.storehouse_name as objectStoreHouseName,
    ddd.detect_device_id as detectDeviceId,
    ddd.detect_device_name as detectDeviceName,
    sd.create_time,sd.update_time,sd.purchase_Date
    from tbl_sheet_detail sd
    left join view_parts_dict vp
    on
    substring(sd.part_id,1,5)=vp.parts_code
    left join tbl_stock_info st
    on sd.part_code=st.factory_parts_code
    left join tbl_asset_attributes aa
    on sd.asset_attributes_id=aa.asset_attributes_id
    left join tbl_detect_device_dict ddd on st.device_id=ddd.detect_device_id
    left join tbl_sheet_info si
    on
    si.sheet_id=sd.sheet_id
    left join tbl_storehouse_dict sd1 on si.source_store_house_id=sd1.storehouse_id
    left join tbl_storehouse_dict sd2 on si.object_store_house_id=sd2.storehouse_id
    <where>
        <if test='eqSheetId != null and eqSheetId != ""'>
            and sd.sheet_id=#{eqSheetId}
        </if>
        <if test='sheetId != null and sheetId != ""'>
            and sd.sheet_id like #{sheetId}
        </if>
        <if test='sheetType != null'>
            and si.sheet_type=#{sheetType}
        </if>
        <if test='sendVerifyFlag != null'>
            and si.send_verify_flag=#{sendVerifyFlag}
        </if>
        <if test='receiptVerifyFlag != null'>
            and si.receipt_verify_flag=#{receiptVerifyFlag}
        </if>
        <if test='supplierName != null and supplierName != ""'>
            and vp.supplier_name=#{supplierName}
        </if>
        <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
            and
            si.source_store_house_id=to_number(#{sourceStoreHouseId},'9')
        </if>
        <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
            and
            si.object_store_house_id=to_number(#{objectStoreHouseId},'9')
        </if>
        <if test='partId != null and partId != ""'>
            and sd.part_id like #{partId}
        </if>
        <if test='partCode != null and partCode != ""'>
            and sd.part_code like #{partCode}
        </if>
        <if test='eqPartCode != null and eqPartCode != ""'>
            and sd.part_code = #{eqPartCode}
        </if>
        <if test='devicePartsName != null and devicePartsName != ""'>
            and vp.device_parts_name = #{devicePartsName}
        </if>

        <if test='deviceModelName != null and deviceModelName != ""'>
            and vp.device_model_name=#{deviceModelName}
        </if>

        <if test='deviceTypeName != null and deviceTypeName != ""'>
            and vp.device_type_name=#{deviceTypeName}
        </if>
        <if test='queryTime != null and queryTime != ""'>
            and si.add_date >= to_timestamp(#{queryTime},
            'yyyy-mm-dd hh24:mi:ss')
        </if>
        <if test='queryTime2 != null and queryTime2 != ""'>
            and si.add_date &lt;= to_timestamp(#{queryTime2},
            'yyyy-mm-dd hh24:mi:ss')
        </if>


        <if test="length != null and start!=null">
            limit #{length} offset {start}
        </if>
        order by sd.create_time desc
    </where>
</select>
    <select id="selectPartsUnstall" parameterType="java.util.Map"
            resultMap="ExtendResultMap">
        select
        sd.sheet_id as sheet_id, sd.part_id, quantity,vp.unit_price,
        sd.remark,
        location,
        part_code,
        aa.asset_attributes_id,
        sd.asset_attributes_name as assetAttrName,
        fault_info,
        fault_date,
        fault_remark,
        prepare_check, machine_check,
        replace_component_check,
        copy_machine_start_time,
        copy_machine_end_time, copy_machine_check,
        checked_date,
        checked_user_id, checked_user_name, review_user_id,
        review_user_name,
        checked_remark,
        checked_price, repaire_state,
        scrap_reason,
        factory_replace_component,
        factory_replace_count,
        factory_repaired_price, factory_repaired_date,used_station_name,
        used_station_id,
        purchase_or_repaired_date, purchase_or_repaired_price,
        st.parts_state as
        part_state,sd.warranty,detect_parts_id,device_parts_name,device_model_name,device_type_name,vp.supplier_name
        as
        supplier_name,aa.asset_attributes_name as asset_attributes_name,send_verify_flag,receipt_verify_flag,
        sd1.storehouse_name as sourceStoreHouseName,
        sd2.storehouse_name as objectStoreHouseName,
        ddd.detect_device_id as detectDeviceId,
        ddd.detect_device_name as detectDeviceName,
        sd.create_time,sd.update_time
        from tbl_sheet_detail sd
        left join view_parts_dict vp
        on
        substring(sd.part_id,1,5)=vp.parts_code
        left join tbl_stock_info st
        on sd.part_id=st.part_id_seq
        left join tbl_asset_attributes aa
        on st.asset_attributes_id=aa.asset_attributes_id
        left join tbl_detect_device_dict ddd on st.device_id=ddd.detect_device_id
        left join tbl_sheet_info si
        on
        si.sheet_id=sd.sheet_id
        left join tbl_storehouse_dict sd1 on si.source_store_house_id=sd1.storehouse_id
        left join tbl_storehouse_dict sd2 on si.object_store_house_id=sd2.storehouse_id
        <where>
            <if test='eqSheetId != null and eqSheetId != ""'>
                and sd.sheet_id=#{eqSheetId}
            </if>
            <if test='sheetId != null and sheetId != ""'>
                and sd.sheet_id like #{sheetId}
            </if>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
                and
                si.source_store_house_id=to_number(#{sourceStoreHouseId},'9')
            </if>
            <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
                and
                si.object_store_house_id=to_number(#{objectStoreHouseId},'9')
            </if>
            <if test='partId != null and partId != ""'>
                and sd.part_id like #{partId}
            </if>
            <if test='partCode != null and partCode != ""'>
                and sd.part_code like #{partCode}
            </if>
            <if test='eqPartCode != null and eqPartCode != ""'>
                and sd.part_code = #{eqPartCode}
            </if>
            <if test='devicePartsName != null and devicePartsName != ""'>
                and vp.device_parts_name = #{devicePartsName}
            </if>

            <if test='deviceModelName != null and deviceModelName != ""'>
                and vp.device_model_name=#{deviceModelName}
            </if>

            <if test='deviceTypeName != null and deviceTypeName != ""'>
                and vp.device_type_name=#{deviceTypeName}
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.add_date >= to_timestamp(#{queryTime},
                'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.add_date &lt;= to_timestamp(#{queryTime2},
                'yyyy-mm-dd hh24:mi:ss')
            </if>


            <if test="length != null and start!=null">
                limit #{length} offset {start}
            </if>
            order by sd.create_time desc
        </where>
    </select>
    <select id="selectStockWithSheetId" parameterType="java.util.Map"
            resultMap="ExtendResultMap">
        select
        si.sheet_id as sheet_id, si.part_id_seq as part_id, quantity,sd.unit_price,
        sd.remark,
        location,
        si.factory_parts_code as part_code,
        aa.asset_attributes_id as asset_attributes_id,
        aa.asset_attributes_name as asset_attributes_name,
        fault_info,
        fault_date,
        fault_remark,
        prepare_check, machine_check,
        replace_component_check,
        copy_machine_start_time,
        copy_machine_end_time, copy_machine_check,
        checked_date,
        checked_user_id, checked_user_name, review_user_id,
        review_user_name,
        checked_remark,
        checked_price, repaire_state,
        scrap_reason,
        factory_replace_component,
        factory_replace_count,
        factory_repaired_price, factory_repaired_date, ddd.detect_device_name as used_station_name,
        ddd.detect_device_id as used_station_id,
        purchase_or_repaired_date, purchase_or_repaired_price,
        si.parts_state as
        part_state,si.warranty,detect_parts_id,device_parts_name,device_model_name,device_type_name,vp.supplier_name
        ,si.create_time,si.update_time,sd.purchase_date,si.purchase_price
        from tbl_stock_info si
        left join view_parts_dict vp on substring(si.part_id_seq,1,5)=vp.parts_code
        left join tbl_sheet_detail sd on si.sheet_id=sd.sheet_id and si.part_id_seq=sd.part_id
        left join tbl_asset_attributes aa on si.asset_attributes_id=aa.asset_attributes_id
        left join tbl_detect_device_dict ddd on si.device_id=ddd.detect_device_id
        left join tbl_sheet_info sh on si.sheet_id=sh.sheet_id
        where si.enabled=1
        <if test="isConsume != null and isConsume != ''">
            and vp.is_consume=#{isConsume}
        </if>
        <if test="addDate != null and addDate  != ''">
            and sh.add_date=to_timestamp(#{addDate},
            'yyyy-mm-dd hh24:mi:ss')
        </if>
        <if test="partsCode != null and partsCode != ''">
            and si.factory_parts_code=#{partsCode}
        </if>
        <if test="sendVerifyDate != null and sendVerifyDate != ''">
            and sh.send_verify_date=#{sendVerifyDate}
        </if>
        <if test="eqAssetAttribute != null and eqAssetAttribute != ''">
            and si.asset_attributes_id=#{eqAssetAttribute}
        </if>
        <if test="eqAssetAttributeOrNull != null and eqAssetAttributeOrNull != ''">
            and (si.asset_attributes_id=#{eqAssetAttributeOrNull} or si.asset_attributes_id is null)
        </if>
        <if test="receiptVerifyDate != null and receiptVerifyDate != ''">
            and sh.receipt_verify_date=#{receiptVerifyDate}
        </if>
        <if test="sendVerifyFlag != null and sendVerifyFlag != ''">
            and sh.send_verify_flag=#{sendVerifyFlag}
        </if>
        <if test="receiptVerifyFlag != null and receiptVerifyFlag != ''">
            and sh.receipt_verify_flag=#{receiptVerifyFlag}
        </if>
        <if test="eqFactoryPartsCode != null and eqFactoryPartsCode != ''">
            AND si.factory_parts_code like
            #{eqFactoryPartsCode,jdbcType=VARCHAR}
        </if>
        <if test="partIdSeq != null and partIdSeq != ''">
            AND si.part_id_seq like #{partIdSeq,jdbcType=VARCHAR}
        </if>
        <if test="eqStorehouseId != null">
            AND si.storehouse_id = #{eqStorehouseId,jdbcType=NUMERIC}
        </if>
        <if test="eqEnabled != null">
            AND si.enabled = #{eqEnabled,jdbcType=NUMERIC}
        </if>
        <if test="eqAssetAttributesId != null and eqAssetAttributesId !=''">
            AND si.asset_attributes_id =
            #{eqAssetAttributesId,jdbcType=NUMERIC}
        </if>
        <if test="eqSheetId != null and eqSheetId !=''">
            AND si.sheet_id =
            #{eqSheetId,jdbcType=VARCHAR}
        </if>
        <if test="eqWarranty != null and eqWarranty !=''">
            AND si.warranty =
            #{eqWarranty,jdbcType=NUMERIC}
        </if>
        <if test='devicePartsName != null and devicePartsName != ""'>
            and vp.device_parts_name = #{devicePartsName}
        </if>

        <if test='deviceModelName != null and deviceModelName != ""'>
            and vp.device_model_name=#{deviceModelName}
        </if>

        <if test='deviceTypeName != null and deviceTypeName != ""'>
            and vp.device_type_name=#{deviceTypeName}
        </if>
        <if test='supplierName != null and supplierName != ""'>
            and vp.supplier_name=#{supplierName}
        </if>
        <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
            and
            sh.source_store_house_id=to_number(#{sourceStoreHouseId},'9')
        </if>
        <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
            and
            sh.object_store_house_id=to_number(#{objectStoreHouseId},'9')
        </if>
        <if test='repaireState != null and repaireState != ""'>
            and
            sd.repaire_state=to_number(#{repaireState},'9')
        </if>
        <if test='subPartId !=null and subPartId !="" '>
            and substring(si.part_id_seq,1,5) = #{subPartId}
        </if>
        order by si.create_time desc

    </select>
    <select id="selectWithStock" parameterType="java.util.Map"
            resultMap="ExtendResultMap">
        select
        sd.sheet_id as sheet_id, sd.part_id, quantity,sd.unit_price,
        sd.remark,
        location,
        part_code,
        sd.asset_attributes_id,
        fault_info,
        fault_date,
        fault_remark,
        prepare_check, machine_check,
        replace_component_check,
        copy_machine_start_time,
        copy_machine_end_time, copy_machine_check,
        checked_date,
        checked_user_id, checked_user_name, review_user_id,
        review_user_name,
        checked_remark,
        checked_price, repaire_state,
        scrap_reason,
        factory_replace_component,
        factory_replace_count,
        factory_repaired_price, factory_repaired_date, used_station_name,
        used_station_id,
        purchase_or_repaired_date, purchase_or_repaired_price,
        part_state,sd.warranty,detect_parts_id,device_parts_name,device_model_name,device_type_name,vp.supplier_name
        as
        supplier_name,send_verify_flag,receipt_verify_flag,si.parts_state,si.asset_attributes_id as asset_attr_id
        from
        tbl_sheet_detail sd,tbl_stock_info si,tbl_sheet_info
        sh,view_parts_dict vp
        where
        si.factory_parts_code=sd.part_code and
        sd.sheet_id=sh.sheet_id
        and si.part_id_seq=vp.parts_code
        <if test="addDate != null and addDate  != ''">
            and sh.add_date=to_timestamp(#{addDate},
            'yyyy-mm-dd hh24:mi:ss')
        </if>
        <if test="partCode != null and partCode != ''">
            and si.factory_parts_code=#{partCode}
        </if>
        <if test="sendVerifyDate != null and sendVerifyDate != ''">
            and sh.send_verify_date=#{sendVerifyDate}
        </if>
        <if test="receiptVerifyDate != null and receiptVerifyDate != ''">
            and sh.receipt_verify_date=#{receiptVerifyDate}
        </if>
        <if test="sendVerifyFlag != null and sendVerifyFlag != ''">
            and sh.send_verify_flag=#{sendVerifyFlag}
        </if>
        <if test="receiptVerifyFlag != null and receiptVerifyFlag != ''">
            and sh.receipt_verify_flag=#{receiptVerifyFlag}
        </if>
        <if test="orderByClause != null">
            order by ${orderByClause}
        </if>
    </select>
    <select id="selectMaxDateByPartCode"
            parameterType="java.util.Map" resultType="java.util.Date">
        SELECT max(si.add_date) FROM tbl_sheet_info
        si,tbl_sheet_detail sd
        where si.sheet_id=sd.sheet_id
        <if test="partCode != null and partCode != ''">
            and sd.part_code=#{partCode}
        </if>
        <if test="orderByClause != null">
            order by ${orderByClause}
        </if>
    </select>
    <delete id="deleteByPrimaryKey"
            parameterType="com.kthw.pmis.entiy.SheetDetailKey">
		delete from tbl_sheet_detail
		where sheet_id =
		#{sheetId,jdbcType=VARCHAR}
		and part_code =
		#{partCode,jdbcType=VARCHAR}
	</delete>
    <delete id="deleteByPartCode" parameterType="String">
		delete from tbl_sheet_detail
		where
		part_code =#{partCode,jdbcType=VARCHAR}
	</delete>
    <!-- 批量删除单据下的配件详情 -->
    <delete id="deleteBySheetId" parameterType="String">
		delete from
		tbl_sheet_detail where sheet_id =#{sheetId}
	</delete>
    <insert id="insert"
            parameterType="com.kthw.pmis.entiy.SheetDetail">
		insert into tbl_sheet_detail (sheet_id, part_id,
		quantity,
		unit_price, remark, location,
		part_code, asset_attributes_id,
		fault_info,
		fault_date, fault_remark, prepare_check,
		machine_check,
		replace_component_check, copy_machine_start_time,
		copy_machine_end_time, copy_machine_check,
		checked_date,
		checked_user_id, checked_user_name,
		review_user_id, review_user_name,
		checked_remark,
		checked_price, repaire_state, scrap_reason,
		factory_replace_component, factory_replace_count,
		factory_repaired_price, factory_repaired_date,
		used_station_name,
		used_station_id, purchase_or_repaired_date,
		purchase_or_repaired_price, part_state,warranty,detect_parts_id,purchase_date,asset_attributes_name)
		values
		(#{sheetId,jdbcType=VARCHAR}, #{partId,jdbcType=VARCHAR},
		#{quantity,jdbcType=NUMERIC},
		#{unitPrice,jdbcType=NUMERIC},
		#{remark,jdbcType=VARCHAR}, #{location,jdbcType=VARCHAR},
		#{partCode,jdbcType=VARCHAR}, #{assetAttributesId,jdbcType=NUMERIC},
		#{faultInfo,jdbcType=VARCHAR},
		#{faultDate,jdbcType=TIMESTAMP},
		#{faultRemark,jdbcType=VARCHAR}, #{prepareCheck,jdbcType=VARCHAR},
		#{machineCheck,jdbcType=VARCHAR},
		#{replaceComponentCheck,jdbcType=VARCHAR},
		#{copyMachineStartTime,jdbcType=TIMESTAMP},
		#{copyMachineEndTime,jdbcType=TIMESTAMP},
		#{copyMachineCheck,jdbcType=VARCHAR},
		#{checkedDate,jdbcType=TIMESTAMP}, #{checkedUserId,jdbcType=VARCHAR},
		#{checkedUserName,jdbcType=VARCHAR},
		#{reviewUserId,jdbcType=VARCHAR},
		#{reviewUserName,jdbcType=VARCHAR},
		#{checkedRemark,jdbcType=VARCHAR},
		#{checkedPrice,jdbcType=NUMERIC}, #{repaireState,jdbcType=NUMERIC},
		#{scrapReason,jdbcType=VARCHAR},
		#{factoryReplaceComponent,jdbcType=VARCHAR},
		#{factoryReplaceCount,jdbcType=NUMERIC},
		#{factoryRepairedPrice,jdbcType=NUMERIC},
		#{factoryRepairedDate,jdbcType=TIMESTAMP},
		#{usedStationName,jdbcType=VARCHAR},
		#{usedStationId,jdbcType=NUMERIC},
		#{purchaseOrRepairedDate,jdbcType=TIMESTAMP},
		#{purchaseOrRepairedPrice,jdbcType=NUMERIC},
		#{partState,jdbcType=NUMERIC},
		#{warranty,jdbcType=NUMERIC},
		#{detectPartsId,jdbcType=NUMERIC},
		#{purchaseDate,jdbcType=TIMESTAMP},
		#{assetAttributesName,jdbcType=VARCHAR})
	</insert>
    <insert id="insertSelective"
            parameterType="com.kthw.pmis.entiy.SheetDetail">
        insert into tbl_sheet_detail
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="sheetId != null">
                sheet_id,
            </if>
            <if test="partId != null">
                part_id,
            </if>
            <if test="quantity != null">
                quantity,
            </if>
            <if test="unitPrice != null">
                unit_price,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="location != null">
                location,
            </if>
            <if test="partCode != null">
                part_code,
            </if>
            <if test="assetAttributesId != null">
                asset_attributes_id,
            </if>
            <if test="faultInfo != null">
                fault_info,
            </if>
            <if test="faultDate != null">
                fault_date,
            </if>
            <if test="faultRemark != null">
                fault_remark,
            </if>
            <if test="prepareCheck != null">
                prepare_check,
            </if>
            <if test="machineCheck != null">
                machine_check,
            </if>
            <if test="replaceComponentCheck != null">
                replace_component_check,
            </if>
            <if test="copyMachineStartTime != null">
                copy_machine_start_time,
            </if>
            <if test="copyMachineEndTime != null">
                copy_machine_end_time,
            </if>
            <if test="copyMachineCheck != null">
                copy_machine_check,
            </if>
            <if test="checkedDate != null">
                checked_date,
            </if>
            <if test="checkedUserId != null">
                checked_user_id,
            </if>
            <if test="checkedUserName != null">
                checked_user_name,
            </if>
            <if test="reviewUserId != null">
                review_user_id,
            </if>
            <if test="reviewUserName != null">
                review_user_name,
            </if>
            <if test="checkedRemark != null">
                checked_remark,
            </if>
            <if test="checkedPrice != null">
                checked_price,
            </if>
            <if test="repaireState != null">
                repaire_state,
            </if>
            <if test="scrapReason != null">
                scrap_reason,
            </if>
            <if test="factoryReplaceComponent != null">
                factory_replace_component,
            </if>
            <if test="factoryReplaceCount != null">
                factory_replace_count,
            </if>
            <if test="factoryRepairedPrice != null">
                factory_repaired_price,
            </if>
            <if test="factoryRepairedDate != null">
                factory_repaired_date,
            </if>
            <if test="usedStationName != null">
                used_station_name,
            </if>
            <if test="usedStationId != null">
                used_station_id,
            </if>
            <if test="purchaseOrRepairedDate != null">
                purchase_or_repaired_date,
            </if>
            <if test="purchaseOrRepairedPrice != null">
                purchase_or_repaired_price,
            </if>
            <if test="partState != null">
                part_state,
            </if>
            <if test="warranty != null">
                warranty,
            </if>
            <if test="detectPartsId != null">
                detect_parts_id,
            </if>
            <if test="purchaseDate != null">
                purchase_date,
            </if>
            <if test="newPartCode != null">
                new_part_code,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="sheetId != null">
                #{sheetId,jdbcType=VARCHAR},
            </if>
            <if test="partId != null">
                #{partId,jdbcType=VARCHAR},
            </if>
            <if test="quantity != null">
                #{quantity,jdbcType=NUMERIC},
            </if>
            <if test="unitPrice != null">
                #{unitPrice,jdbcType=NUMERIC},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="location != null">
                #{location,jdbcType=VARCHAR},
            </if>
            <if test="partCode != null">
                #{partCode,jdbcType=VARCHAR},
            </if>
            <if test="assetAttributesId != null">
                #{assetAttributesId,jdbcType=NUMERIC},
            </if>
            <if test="faultInfo != null">
                #{faultInfo,jdbcType=VARCHAR},
            </if>
            <if test="faultDate != null">
                #{faultDate,jdbcType=TIMESTAMP},
            </if>
            <if test="faultRemark != null">
                #{faultRemark,jdbcType=VARCHAR},
            </if>
            <if test="prepareCheck != null">
                #{prepareCheck,jdbcType=VARCHAR},
            </if>
            <if test="machineCheck != null">
                #{machineCheck,jdbcType=VARCHAR},
            </if>
            <if test="replaceComponentCheck != null">
                #{replaceComponentCheck,jdbcType=VARCHAR},
            </if>
            <if test="copyMachineStartTime != null">
                #{copyMachineStartTime,jdbcType=TIMESTAMP},
            </if>
            <if test="copyMachineEndTime != null">
                #{copyMachineEndTime,jdbcType=TIMESTAMP},
            </if>
            <if test="copyMachineCheck != null">
                #{copyMachineCheck,jdbcType=VARCHAR},
            </if>
            <if test="checkedDate != null">
                #{checkedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="checkedUserId != null">
                #{checkedUserId,jdbcType=VARCHAR},
            </if>
            <if test="checkedUserName != null">
                #{checkedUserName,jdbcType=VARCHAR},
            </if>
            <if test="reviewUserId != null">
                #{reviewUserId,jdbcType=VARCHAR},
            </if>
            <if test="reviewUserName != null">
                #{reviewUserName,jdbcType=VARCHAR},
            </if>
            <if test="checkedRemark != null">
                #{checkedRemark,jdbcType=VARCHAR},
            </if>
            <if test="checkedPrice != null">
                #{checkedPrice,jdbcType=NUMERIC},
            </if>
            <if test="repaireState != null">
                #{repaireState,jdbcType=NUMERIC},
            </if>
            <if test="scrapReason != null">
                #{scrapReason,jdbcType=VARCHAR},
            </if>
            <if test="factoryReplaceComponent != null">
                #{factoryReplaceComponent,jdbcType=VARCHAR},
            </if>
            <if test="factoryReplaceCount != null">
                #{factoryReplaceCount,jdbcType=NUMERIC},
            </if>
            <if test="factoryRepairedPrice != null">
                #{factoryRepairedPrice,jdbcType=NUMERIC},
            </if>
            <if test="factoryRepairedDate != null">
                #{factoryRepairedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="usedStationName != null">
                #{usedStationName,jdbcType=VARCHAR},
            </if>
            <if test="usedStationId != null">
                #{usedStationId,jdbcType=NUMERIC},
            </if>
            <if test="purchaseOrRepairedDate != null">
                #{purchaseOrRepairedDate,jdbcType=TIMESTAMP},
            </if>
            <if test="purchaseOrRepairedPrice != null">
                #{purchaseOrRepairedPrice,jdbcType=NUMERIC},
            </if>
            <if test="partState != null">
                #{partState,jdbcType=NUMERIC},
            </if>
            <if test="warranty != null">
                #{warranty,jdbcType=NUMERIC},
            </if>
            <if test="detectPartsId != null">
                #{detectPartsId,jdbcType=NUMERIC},
            </if>
            <if test="purchaseDate != null">
                #{purchaseDate,jdbcType=TIMESTAMP},
            </if>
            <if test="newPartCode != null">
                #{newPartCode,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <update id="updateByPrimaryKeySelective"
            parameterType="com.kthw.pmis.entiy.SheetDetail">
        update tbl_sheet_detail
        <include refid="ByMap_Set_Clause"/>
        where sheet_id = #{sheetId,jdbcType=VARCHAR}
        and part_code =
        #{partCode,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey"
            parameterType="com.kthw.pmis.entiy.SheetDetail">
		update tbl_sheet_detail
		set quantity =
		#{quantity,jdbcType=NUMERIC},
		unit_price =
		#{unitPrice,jdbcType=NUMERIC},
		remark = #{remark,jdbcType=VARCHAR},
		location = #{location,jdbcType=VARCHAR},
		part_Id=
		#{partId,jdbcType=VARCHAR},
		asset_attributes_id =
		#{assetAttributesId,jdbcType=NUMERIC},
		fault_info =
		#{faultInfo,jdbcType=VARCHAR},
		fault_date =
		#{faultDate,jdbcType=TIMESTAMP},
		fault_remark =
		#{faultRemark,jdbcType=VARCHAR},
		prepare_check =
		#{prepareCheck,jdbcType=VARCHAR},
		machine_check =
		#{machineCheck,jdbcType=VARCHAR},
		replace_component_check =
		#{replaceComponentCheck,jdbcType=VARCHAR},
		copy_machine_start_time =
		#{copyMachineStartTime,jdbcType=TIMESTAMP},
		copy_machine_end_time =
		#{copyMachineEndTime,jdbcType=TIMESTAMP},
		copy_machine_check =
		#{copyMachineCheck,jdbcType=VARCHAR},
		checked_date =
		#{checkedDate,jdbcType=TIMESTAMP},
		checked_user_id =
		#{checkedUserId,jdbcType=VARCHAR},
		checked_user_name =
		#{checkedUserName,jdbcType=VARCHAR},
		review_user_id =
		#{reviewUserId,jdbcType=VARCHAR},
		review_user_name =
		#{reviewUserName,jdbcType=VARCHAR},
		checked_remark =
		#{checkedRemark,jdbcType=VARCHAR},
		checked_price =
		#{checkedPrice,jdbcType=NUMERIC},
		repaire_state =
		#{repaireState,jdbcType=NUMERIC},
		scrap_reason =
		#{scrapReason,jdbcType=VARCHAR},
		factory_replace_component =
		#{factoryReplaceComponent,jdbcType=VARCHAR},
		factory_replace_count =
		#{factoryReplaceCount,jdbcType=NUMERIC},
		factory_repaired_price =
		#{factoryRepairedPrice,jdbcType=NUMERIC},
		factory_repaired_date =
		#{factoryRepairedDate,jdbcType=TIMESTAMP},
		used_station_name =
		#{usedStationName,jdbcType=VARCHAR},
		used_station_id =
		#{usedStationId,jdbcType=NUMERIC},
		purchase_or_repaired_date =
		#{purchaseOrRepairedDate,jdbcType=TIMESTAMP},
		purchase_or_repaired_price =
		#{purchaseOrRepairedPrice,jdbcType=NUMERIC},
		part_state =
		#{partState,jdbcType=NUMERIC},
		warranty =
		#{warranty,jdbcType=NUMERIC},
		detect_parts_id =
		#{detectPartsId,jdbcType=NUMERIC}
		where sheet_id =
		#{sheetId,jdbcType=VARCHAR}
		and part_code =
		#{partCode,jdbcType=VARCHAR}

	</update>
    <update id="updateByMap" parameterType="java.util.Map">
        update tbl_sheet_detail
        <if test="_parameter != null">
            <include refid="ByMap_Set_Clause"/>
            <include refid="ByMap_Where_Clause"/>
        </if>
    </update>
    <update id="updatePartCode" parameterType="java.util.Map">
        update tbl_sheet_detail
        <set>
            <if test="partCode != null">
                part_code=#{partCode,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null">
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where part_code=#{sourcePartCode} and sheet_id=#{sheetId}
    </update>
    <update id="batchUpdate" parameterType="java.util.List">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update tbl_sheet_detail
            <set>
                <if test="item.quantity != null">
                    quantity = #{item.quantity,jdbcType=NUMERIC},
                </if>
                <if test="item.unitPrice != null">
                    unit_price = #{item.unitPrice,jdbcType=NUMERIC},
                </if>
                <if test="item.remark != null">
                    remark = #{item.remark,jdbcType=VARCHAR},
                </if>
                <if test="item.location != null">
                    location = #{item.location,jdbcType=VARCHAR},
                </if>
                <if test="item.partId != null">
                    part_id = #{item.partId,jdbcType=VARCHAR},
                </if>
                <if test="item.assetAttributesId != null">
                    asset_attributes_id =
                    #{item.assetAttributesId,jdbcType=NUMERIC},
                </if>
                <if test="item.faultInfo != null">
                    fault_info = #{item.faultInfo,jdbcType=VARCHAR},
                </if>
                <if test="item.faultDate != null">
                    fault_date = #{item.faultDate,jdbcType=TIMESTAMP},
                </if>
                <if test="item.faultRemark != null">
                    fault_remark = #{item.faultRemark,jdbcType=VARCHAR},
                </if>
                <if test="item.prepareCheck != null">
                    prepare_check = #{item.prepareCheck,jdbcType=VARCHAR},
                </if>
                <if test="item.machineCheck != null">
                    machine_check = #{item.machineCheck,jdbcType=VARCHAR},
                </if>
                <if test="item.replaceComponentCheck != null">
                    replace_component_check =
                    #{item.replaceComponentCheck,jdbcType=VARCHAR},
                </if>
                <if test="item.copyMachineStartTime != null">
                    copy_machine_start_time =
                    #{item.copyMachineStartTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.copyMachineEndTime != null">
                    copy_machine_end_time =
                    #{item.copyMachineEndTime,jdbcType=TIMESTAMP},
                </if>
                <if test="item.copyMachineCheck != null">
                    copy_machine_check =
                    #{item.copyMachineCheck,jdbcType=VARCHAR},
                </if>
                <if test="item.checkedDate != null">
                    checked_date = #{item.checkedDate,jdbcType=TIMESTAMP},
                </if>
                <if test="item.checkedUserId != null">
                    checked_user_id = #{item.checkedUserId,jdbcType=VARCHAR},
                </if>
                <if test="item.checkedUserName != null">
                    checked_user_name = #{item.checkedUserName,jdbcType=VARCHAR},
                </if>
                <if test="item.reviewUserId != null">
                    review_user_id = #{item.reviewUserId,jdbcType=VARCHAR},
                </if>
                <if test="item.reviewUserName != null">
                    review_user_name = #{item.reviewUserName,jdbcType=VARCHAR},
                </if>
                <if test="item.checkedRemark != null">
                    checked_remark = #{item.checkedRemark,jdbcType=VARCHAR},
                </if>
                <if test="item.checkedPrice != null">
                    checked_price = #{item.checkedPrice,jdbcType=NUMERIC},
                </if>
                <if test="item.repaireState != null">
                    repaire_state = #{item.repaireState,jdbcType=NUMERIC},
                </if>
                <if test="item.scrapReason != null">
                    scrap_reason = #{item.scrapReason,jdbcType=VARCHAR},
                </if>
                <if test="item.factoryReplaceComponent != null">
                    factory_replace_component =
                    #{item.factoryReplaceComponent,jdbcType=VARCHAR},
                </if>
                <if test="item.factoryReplaceCount != null">
                    factory_replace_count =
                    #{item.factoryReplaceCount,jdbcType=NUMERIC},
                </if>
                <if test="item.factoryRepairedPrice != null">
                    factory_repaired_price =
                    #{item.factoryRepairedPrice,jdbcType=NUMERIC},
                </if>
                <if test="item.factoryRepairedDate != null">
                    factory_repaired_date =
                    #{item.factoryRepairedDate,jdbcType=TIMESTAMP},
                </if>
                <if test="item.usedStationName != null">
                    used_station_name = #{item.usedStationName,jdbcType=VARCHAR},
                </if>
                <if test="item.usedStationId != null">
                    used_station_id = #{item.usedStationId,jdbcType=NUMERIC},
                </if>
                <if test="item.purchaseOrRepairedDate != null">
                    purchase_or_repaired_date =
                    #{item.purchaseOrRepairedDate,jdbcType=TIMESTAMP},
                </if>
                <if test="item.purchaseOrRepairedPrice != null">
                    purchase_or_repaired_price =
                    #{item.purchaseOrRepairedPrice,jdbcType=NUMERIC},
                </if>
                <if test="item.partState != null">
                    part_state = #{item.partState,jdbcType=NUMERIC},
                </if>
                <if test="item.warranty != null">
                    warranty = #{item.warranty,jdbcType=NUMERIC},
                </if>
                <if test="item.detectPartsId != null">
                    detect_parts_id = #{item.detectPartsId,jdbcType=NUMERIC},
                </if>
            </set>
            <include refid="ByMap_Where_Clause"/>


        </foreach>
    </update>


    <resultMap id="StatictsResultMap"
               type="com.kthw.pmis.entiy.dto.PartsStatictsDTO">
        <result column="unit_price" jdbcType="NUMERIC"
                property="unitPrice"/>
        <result column="count" jdbcType="NUMERIC"
                property="count"/>
        <result column="part_id" jdbcType="VARCHAR" property="partId"/>
        <result column="device_parts_name" jdbcType="VARCHAR"
                property="devicePartsName"/>
        <result column="device_model_name" jdbcType="VARCHAR"
                property="deviceModelName"/>
        <result column="device_type_name" jdbcType="VARCHAR"
                property="deviceTypeName"/>
        <result column="supplier_name" jdbcType="VARCHAR"
                property="supplierName"/>
        <result column="asset_attributes_id" jdbcType="NUMERIC"
                property="assetAttributesId"/>

    </resultMap>
    <select id="getPartsCount"  parameterType="java.util.Map"
            resultMap="StatictsResultMap">
        SELECT ${groupByParam},count(*) as count from tbl_sheet_detail sd
        LEFT JOIN view_parts_dict vp on SUBSTRING(sd.part_id,1,5)=vp.parts_code
        RIGHT JOIN tbl_sheet_info si on si.sheet_id=sd.sheet_id

        <where>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='devicePartsName != null and devicePartsName != ""'>
                and vp.device_parts_name = #{devicePartsName}
            </if>

            <if test='deviceModelName != null and deviceModelName != ""'>
                and vp.device_model_name=#{deviceModelName}
            </if>

            <if test='deviceTypeName != null and deviceTypeName != ""'>
                and vp.device_type_name=#{deviceTypeName}
            </if>
            <if test='assetAttributesId != null and assetAttributesId != ""'>
                and sd.asset_attributes_id=#{assetAttributesId}
            </if>
            <if test='partState != null and partState != ""'>
                and sd.part_state=#{partState}
            </if>
            <if test='repairPartState != null and repairPartState != ""'>
                and sd.part_state!=#{repairPartState}
            </if>
            <if test='sendVerifyDate != null and sendVerifyDate != ""'>
                and si.send_verify_date >= to_timestamp(#{sendVerifyDate},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='sendVerifyDate2 != null and sendVerifyDate2 != ""'>
                and si.send_verify_date &lt;= to_timestamp(#{sendVerifyDate2},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.receipt_verify_date >= to_timestamp(#{queryTime},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.receipt_verify_date &lt;= to_timestamp(#{queryTime2},'yyyy-mm-dd hh24:mi:ss')
            </if>
        </where>
        GROUP BY ${groupByParam}

    </select>
    <select id="getPartsPrice"  parameterType="java.util.Map"
            resultType="Integer">
        SELECT sum(sd.purchase_or_repaired_price) from tbl_sheet_detail sd
        LEFT JOIN view_parts_dict vp on SUBSTRING(sd.part_id,1,5)=vp.parts_code
        RIGHT JOIN tbl_sheet_info si on si.sheet_id=sd.sheet_id
        <where>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='devicePartsName != null and devicePartsName != ""'>
                and vp.device_parts_name = #{devicePartsName}
            </if>

            <if test='deviceModelName != null and deviceModelName != ""'>
                and vp.device_model_name=#{deviceModelName}
            </if>

            <if test='deviceTypeName != null and deviceTypeName != ""'>
                and vp.device_type_name=#{deviceTypeName}
            </if>
            <if test='assetAttributesId != null and assetAttributesId != ""'>
                and sd.asset_attributes_id=#{assetAttributesId}
            </if>
            <if test='partState != null and partState != ""'>
                and sd.part_state=#{partState}
            </if>
            <if test='repairPartState != null and repairPartState != ""'>
                and sd.part_state!=#{repairPartState}
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.send_verify_date >= to_timestamp(#{queryTime},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.send_verify_date &lt;= to_timestamp(#{queryTime2},'yyyy-mm-dd hh24:mi:ss')
            </if>
        </where>

    </select>
    <select id="getPartsBySheetType" parameterType="java.util.Map"
            resultMap="ExtendResultMap">
        SELECT sd.part_id,sd.part_code,sd.asset_attributes_id,
        sd.part_state,sd.purchase_or_repaired_price,sd.checked_remark,
        vp.device_parts_name,vp.device_model_name,vp.device_type_name,vp.supplier_name	from tbl_sheet_detail sd
        RIGHT JOIN tbl_sheet_info si on si.sheet_id=sd.sheet_id
        left join view_parts_dict vp on substring(sd.part_id,1,5)=vp.parts_code
        <where>
            <if test='sheetType != null'>
                and si.sheet_type=#{sheetType}
            </if>
            <if test='sendVerifyFlag != null'>
                and si.send_verify_flag=#{sendVerifyFlag}
            </if>
            <if test='receiptVerifyFlag != null'>
                and si.receipt_verify_flag=#{receiptVerifyFlag}
            </if>
            <if test='supplierName != null and supplierName != ""'>
                and vp.supplier_name=#{supplierName}
            </if>
            <if test='assetAttributesId != null and assetAttributesId != ""'>
                and sd.asset_attributes_id=#{assetAttributesId}
            </if>
            <if test='partState != null and partState != ""'>
                and sd.part_state=#{partState}
            </if>
            <if test='repairPartState != null and repairPartState != ""'>
                and sd.part_state!=#{repairPartState}
            </if>
            <if test='repaireState != null and repaireState != ""'>
                and sd.repaire_state =#{repaireState}
            </if>
            <if test='sourceStoreHouseId != null and sourceStoreHouseId != ""'>
                and si.source_store_house_id =#{sourceStoreHouseId}
            </if>
            <if test='objectStoreHouseId != null and objectStoreHouseId != ""'>
                and si.object_store_house_id =#{objectStoreHouseId}
            </if>
            <if test='sendVerifyDate != null and sendVerifyDate != ""'>
                and si.send_verify_date >= to_timestamp(#{sendVerifyDate},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='sendVerifyDate2 != null and sendVerifyDate2 != ""'>
                and si.send_verify_date &lt;= to_timestamp(#{sendVerifyDate2},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime != null and queryTime != ""'>
                and si.receipt_verify_date >= to_timestamp(#{queryTime},'yyyy-mm-dd hh24:mi:ss')
            </if>
            <if test='queryTime2 != null and queryTime2 != ""'>
                and si.receipt_verify_date &lt;= to_timestamp(#{queryTime2},'yyyy-mm-dd hh24:mi:ss')
            </if>
        </where>
    </select>

</mapper>